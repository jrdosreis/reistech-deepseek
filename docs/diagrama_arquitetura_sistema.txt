┌─────────────────────────────────────────────────────────────────────────────────┐
│                         ARQUITETURA SISTEMA REISTECH v2.0                       │
│                                                                                 │
├─────────────────────────────────────────────────────────────────────────────────┤
│                              CLIENTE WHATSAPP                                   │
│                                                                                 │
│  ┌──────────────┐      ┌──────────────┐      ┌──────────────┐                  │
│  │   Mensagem   │─────▶│    QR Code   │─────▶│  Conexão     │                  │
│  │   Recebida   │      │   Scan       │      │  Estabelecida│                  │
│  └──────────────┘      └──────────────┘      └──────────────┘                  │
│         │                       │                       │                       │
└─────────┼───────────────────────┼───────────────────────┼───────────────────────┘
          │                       │                       │
          ▼                       ▼                       ▼
┌─────────────────────────────────────────────────────────────────────────────────┐
│                              BACKEND LAYER                                      │
│                                                                                 │
│  ┌─────────────────────────────────────────────────────────────────────────┐    │
│  │                      WHATSAPP-WEB.JS INTEGRATION                        │    │
│  │  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐  ┌─────────────┐ │    │
│  │  │  Sessões     │  │  Mensagens   │  │    Mídia     │  │  Status     │ │    │
│  │  │  Manager     │  │  Processor   │  │  Handler     │  │  Monitor    │ │    │
│  │  └──────────────┘  └──────────────┘  └──────────────┘  └─────────────┘ │    │
│  └─────────────────────────────────────────────────────────────────────────┘    │
│                                  │                                               │
│                                  ▼                                               │
│  ┌─────────────────────────────────────────────────────────────────────────┐    │
│  │                          REISTECH ENGINE (FSM)                         │    │
│  │                                                                         │    │
│  │  ┌──────────────┐      ┌──────────────┐      ┌──────────────┐          │    │
│  │  │   Parser     │─────▶│  State       │─────▶│  Decision    │          │    │
│  │  │   de         │      │  Machine     │      │  Router      │          │    │
│  │  │   Intenção   │      │              │      │              │          │    │
│  │  └──────────────┘      └──────────────┘      └──────────────┘          │    │
│  │         │                       │                       │               │    │
│  │         ▼                       ▼                       ▼               │    │
│  │  ┌──────────────┐      ┌──────────────┐      ┌──────────────┐          │    │
│  │  │   Nicho      │      │   Resposta   │      │   Fila       │          │    │
│  │  │   Detector   │      │   Generator  │      │   Manager    │          │    │
│  │  └──────────────┘      └──────────────┘      └──────────────┘          │    │
│  └─────────────────────────────────────────────────────────────────────────┘    │
│                                  │                                               │
│                                  ▼                                               │
│  ┌─────────────────────────────────────────────────────────────────────────┐    │
│  │                              API GATEWAY                                │    │
│  │                                                                         │    │
│  │  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐  ┌─────────────┐ │    │
│  │  │   Auth       │  │   Rate       │  │   Logging    │  │   CORS      │ │    │
│  │  │   Middleware │  │   Limiter    │  │   Middleware │  │   Handler   │ │    │
│  │  └──────────────┘  └──────────────┘  └──────────────┘  └─────────────┘ │    │
│  └─────────────────────────────────────────────────────────────────────────┘    │
│                                  │                                               │
├──────────────────────────────────┼───────────────────────────────────────────────┤
│                                  ▼                                               │
│  ┌─────────────────────────────────────────────────────────────────────────┐    │
│  │                              SERVICES                                   │    │
│  │                                                                         │    │
│  │  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐  ┌─────────────┐ │    │
│  │  │   Fila       │  │   Conversas  │  │   Catálogo   │  │   CMS       │ │    │
│  │  │   Service    │  │   Service    │  │   Service    │  │   Service   │ │    │
│  │  └──────────────┘  └──────────────┘  └──────────────┘  └─────────────┘ │    │
│  │                                                                         │    │
│  │  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐  ┌─────────────┐ │    │
│  │  │   Reports    │  │   Users      │  │   Workspace  │  │   WhatsApp  │ │    │
│  │  │   Service    │  │   Service    │  │   Service    │  │   Service   │ │    │
│  │  └──────────────┘  └──────────────┘  └──────────────┘  └─────────────┘ │    │
│  └─────────────────────────────────────────────────────────────────────────┘    │
│                                  │                                               │
│                                  ▼                                               │
└──────────────────────────────────┼───────────────────────────────────────────────┘
                                   │
               ┌───────────────────┼───────────────────┐
               ▼                   ▼                   ▼
    ┌───────────────────┐ ┌───────────────────┐ ┌───────────────────┐
    │   POSTGRESQL      │ │      REDIS        │ │   WEBSOCKET       │
    │   Database        │ │   Cache & Pub/Sub │ │   Server          │
    │                   │ │                   │ │                   │
    │  • Workspaces     │ │  • Sessões        │ │  • Conexões       │
    │  • Users          │ │  • Cache          │ │    Ativas        │
    │  • Clientes       │ │  • Fila           │ │  • Eventos        │
    │  • Conversas      │ │    Temporária     │ │    em Tempo Real │
    │  • Catalogo       │ │  • Locks          │ │  • Broadcast     │
    └───────────────────┘ └───────────────────┘ └───────────────────┘
               │                   │                   │
               └───────────────────┼───────────────────┘
                                   │
                                   ▼
┌─────────────────────────────────────────────────────────────────────────────────┐
│                             FRONTEND LAYER                                      │
│                                                                                 │
│  ┌─────────────────────────────────────────────────────────────────────────┐    │
│  │                           REACT APPLICATION                             │    │
│  │                                                                         │    │
│  │  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐  ┌─────────────┐ │    │
│  │  │   Dashboard  │  │   Fila       │  │   Conversas  │  │   Catálogo  │ │    │
│  │  │   Page       │  │   Page       │  │   Page       │  │   Page      │ │    │
│  │  └──────────────┘  └──────────────┘  └──────────────┘  └─────────────┘ │    │
│  │                                                                         │    │
│  │  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐  ┌─────────────┐ │    │
│  │  │   CMS        │  │   WhatsApp   │  │   Config     │  │   Reports   │ │    │
│  │  │   Page       │  │   Page       │  │   Page       │  │   Page      │ │    │
│  │  └──────────────┘  └──────────────┘  └──────────────┘  └─────────────┘ │    │
│  └─────────────────────────────────────────────────────────────────────────┘    │
│                                  │                                               │
│                                  ▼                                               │
│  ┌─────────────────────────────────────────────────────────────────────────┐    │
│  │                           STATE MANAGEMENT                              │    │
│  │                                                                         │    │
│  │  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐  ┌─────────────┐ │    │
│  │  │   Auth       │  │   UI         │  │   WebSocket  │  │   Notif.    │ │    │
│  │  │   Slice      │  │   Slice      │  │   Context    │  │   Context   │ │    │
│  │  └──────────────┘  └──────────────┘  └──────────────┘  └─────────────┘ │    │
│  └─────────────────────────────────────────────────────────────────────────┘    │
│                                  │                                               │
│                                  ▼                                               │
│  ┌─────────────────────────────────────────────────────────────────────────┐    │
│  │                         REAL-TIME UPDATES                               │    │
│  │                                                                         │    │
│  │  • Fila atualiza automaticamente                                        │    │
│  │  • Novas mensagens aparecem em tempo real                               │    │
│  │  • Notificações push para operadores                                    │    │
│  │  • Status de conexão visível                                            │    │
│  └─────────────────────────────────────────────────────────────────────────┘    │
│                                                                                 │
└─────────────────────────────────────────────────────────────────────────────────┘

LEGENDA:
───────
  │     Fluxo de dados
  ──▶   Comunicação principal
  ──┤   Comunicação secundária
  [ ]   Módulo/Componente
  •     Funcionalidade específica
───────